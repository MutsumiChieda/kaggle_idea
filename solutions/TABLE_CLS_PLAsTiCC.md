# [PLAsTiCC Astronomical Classification](https://www.kaggle.com/c/PLAsTiCC-2018)

## どんなコンペだったか  
時間とともに変化する表形式の天文データを用いて天体の形態を分類する多クラス分類．  
天体の形態には変光星，潮汐破壊，超新星爆発，キロノヴァ，太陽系外惑星などがある．  
評価基準は加重多クラスlogloss．  
特徴として，以下の点が際立った．
- ドメイン知識の取得へのハードルが高かった．  
[kaerururu](https://www.kaggle.com/kaerunantoka)は，wikipediaで用語を検索して，ドメイン知識を得た．
- trainデータが少なく(8000レコード)，過学習に繋がった．  
また，極端にレコードの少ないクラスがあった．
- testデータが大きく，リソースが必要になった．  
- testデータのみに存在するクラス"class99"があり，class99へのアプローチによって精度に差がでた．

## 提供されたデータ  
LSST望遠鏡から観測データを取得したら取得できるとされるシミュレーション結果

1. 天体のデータ  
クラス(TARGET)，座標，地球との距離  
天体ごとに1レコード提供される．  
2. 各天体の観測時の時系列明るさデータ  
明るさ，明るさの観測誤差，観測時の光の波長  
天体 x 光の波長 x 観測時間ごとに1レコード提供される．

# [1st](https://www.kaggle.com/c/PLAsTiCC-2018/discussion/75033) (Pri:0.685, pub:0.671)

## モデル
単一のLightGBM

## CV

## 特徴量エンジニアリング
ガウス過程([解説記事](https://qiita.com/sergeant-wizard/items/d5a60d9f9ec08ef2d907))によってライトカーブを予測し，そこから特徴を抽出した．  
波長方向に固定長スケール、時間方向に可変長スケールのMaternカーネル([wikipedia](https://en.wikipedia.org/wiki/Mat%C3%A9rn_covariance_function))を使用して，各オブジェクトに対してガウス過程を学習させた．  
計算コストが高く，3日を要した．  
また，Train/Testの分布の違いに対応するため，トレーニングセットのすべてのライトカーブを40回まで劣化させ，テストセットのサンプリングの少ないライトカーブのように見えるものを取得した．

### 生成した特徴

ライトカーブ関連の特徴
- ピークの明るさやピーク幅などの特徴．  
- 不十分なサンプリングによる不確実性を知らせる特徴(最大光の周りの異なるウィンドウでの観測数カウント)．  
- 各バンドのシグナルtoノイズに関連する特徴．  


### 特徴選択

## データオーグメンテーション
train/test間で明るさの傾向が異なるため，testデータの傾向に合わせてtrainの天体1つにつき40パターンのデータを生成した．

## アンサンブル
無し．

## その他の工夫  
未知のクラスclass99は，LB provingの結果，特定のクラスの予測確率を重み付けした確率だったため，これを再現して予測とした．